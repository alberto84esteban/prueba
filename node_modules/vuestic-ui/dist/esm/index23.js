import{w as e}from"./withConfigTransport.js";import{computed as t,ref as a,watch as r,defineComponent as o,toRefs as n,resolveComponent as l,openBlock as s,createElementBlock as i,createVNode as u,withCtx as p,renderSlot as d,normalizeProps as c,guardReactiveProps as m,mergeProps as v,createSlots as f,createBlock as y,createCommentVNode as j,withModifiers as g,renderList as D}from"vue";import{u as V,a as C,b as I}from"./VaInput.js";import{a as h,b as P,u as k}from"./index60.js";import{a as x}from"./useStateful.js";import{u as b}from"./useForm.js";import{i as S,s as _,a as $,b as w}from"./VaDatePicker.js";import{e as B,a as E,f as O}from"./child-props.js";import T,{VaDropdownContent as F}from"./index25.js";import M from"./index31.js";import L from"./index28.js";import{s as N}from"./style-inject.es.js";import"./VaConfig.js";import"cleave.js";import"./useEmitProxy.js";import"./color-config.js";import"colortranslator";import"./pick.js";import"./VaIcon.js";import"./flatten.js";import"./useSize.js";import"./useSyncProp.js";import"./consts.js";import"./useFocus.js";import"./useColor.js";import"./index8.js";import"./useRouterLink.js";import"./useLoading.js";import"./index39.js";import"./clamp.js";import"./toNumber.js";import"./VaDropdownContent.js";import"tslib";import"./vue-class-component.esm-bundler.js";import"asva-executors";import"@popperjs/core";import"./StatefulMixin.js";import"./VaMessageListWrapper.vue_vue&type=script&lang.js";const defaultParseDateFunction=e=>new Date(Date.parse(e)),useDateParser=e=>{const t=a(!0),parseDate=a=>{const r=(e.parseDate||defaultParseDateFunction)(a);var o;return(!(o=r)||o instanceof Date&&isNaN(o.getTime()))&&(t.value=!1),r};return{parseDateInputValue:a=>{if(t.value=!0,e.parse)return e.parse(a,t);if((t=>t.includes(e.delimiter))(a))return a.split(e.delimiter).map((e=>parseDate(e)));if((t=>t.includes(e.rangeDelimiter))(a)){const[t,r]=a.split(e.rangeDelimiter).map((e=>parseDate(e)));return{start:t,end:r}}return parseDate(a)},isValid:t}},z={...k,...b,label:{type:String,required:!1},color:{type:String,default:"primary"},placeholder:{type:String,default:""},tabindex:{type:Number,default:0},outline:{Boolean:Boolean,default:!1},bordered:{type:Boolean,default:!1}};var H=o({name:"VaDateInput",components:{vaDropdown:T,VaDropdownContent:F,VaDatePicker:_,VaInput:M,VaIcon:L},props:{...B(_),...z,...V,clearValue:{type:Date,default:void 0},resetOnClose:{type:Boolean,default:!0},isOpen:{type:Boolean},format:{type:Function},formatDate:{type:Function,default:()=>e=>e.toLocaleDateString()},parse:{type:Function},parseDate:{type:Function},delimiter:{type:String,default:", "},rangeDelimiter:{type:String,default:" ~ "},manualInput:{type:Boolean,default:!1},leftIcon:{type:Boolean,default:!1},icon:{type:String,default:"calendar_today"}},emits:[...E(_),...C,...h,"update:is-open","update:text"],setup(e,{emit:o,slots:l}){const{isOpen:s,resetOnClose:i}=n(e),{valueComputed:u}=x(e,o),{syncProp:p}=function useSyncProp(e,r,o,n){if(void 0===n)return{syncProp:t({set(e){o(`update:${r}`,e)},get:()=>e.value})};const l=a(n);return{syncProp:t({set(e){l.value=e,o(`update:${r}`,e)},get:()=>void 0===(null==e?void 0:e.value)?l.value:e.value})}}(s,"is-open",o,!1),d=t((()=>!i.value)),{valueComputed:c,reset:m}=((e,o)=>{const n=a(e.value),l=t({get:()=>n.value,set:t=>{if(o.value&&(n.value=t,e.value=t),!t)return e.value=t,void(n.value=t);S(t)?null!==t.end&&(e.value=t):e.value=t,n.value=t}});return r(e,(e=>{n.value=e})),{valueComputed:l,reset:()=>{n.value&&S(n.value)&&(n.value=e.value)}}})(u,d);r(p,(e=>{e||d.value||m()}));const dateOrNothing=t=>t?e.formatDate(t):"...",v=a(),{parseDateInputValue:f,isValid:y}=useDateParser(e),j=t((()=>{if(!y.value)return e.clearValue;if(e.format)return e.format(c.value);if(!c.value)return e.clearValue;if($(c.value))return c.value.map((t=>e.formatDate(t))).join(e.delimiter);if(w(c.value))return e.formatDate(c.value);if(S(c.value))return dateOrNothing(c.value.start)+e.rangeDelimiter+dateOrNothing(c.value.end);throw new Error("VaDatePicker: Invalid model value. Value should be Date, Date[] or { start: Date, end: Date | null }")})),reset=()=>{u.value=e.clearValue,o("clear")},{isFocused:g,computedError:D,computedErrorMessages:V}=P(e,o,reset,(()=>{var e;null===(e=v.value)||void 0===e||e.focus()})),C=t((()=>!y.value&&c.value!==e.clearValue||D.value)),h=t((()=>{const t=[e.leftIcon&&"prependInner",(!e.leftIcon||e.clearable)&&"icon"];return Object.keys(l).filter((e=>!t.includes(e)))})),{canBeCleared:k,clearIconProps:b}=I(e,c,g,C),E=t((()=>({name:e.icon,color:e.color,size:"small",class:"va-date-input__icon"}))),T=O(e,B(M,["rules","error","errorMessages","clearable"]));return{valueText:j,valueComputed:c,isOpenSync:p,onInputTextChanged:({target:e})=>{const t=f(e.value);y.value&&(c.value=t)},hasError:C,computedErrorMessages:V,input:v,inputProps:T,datePickerProps:O(e,B(_)),filterSlots:h,canBeCleared:k,clearIconProps:b,iconProps:E,reset:reset}},methods:{focus(){var e;null===(e=this.input)||void 0===e||e.focus()},blur(){var e;null===(e=this.input)||void 0===e||e.blur()}}});const U={class:"va-date-input"};N(".va-date-input{--va-date-picker-cell-size:28px;display:flex;font-family:var(--va-font-family)}.va-date-input__icon,.va-date-input__input.va-input_readonly{cursor:pointer}.va-date-input .va-dropdown{width:100%}"),H.render=function render(e,t,a,r,o,n){const V=l("va-icon"),C=l("va-input"),I=l("va-date-picker"),h=l("va-dropdown-content"),P=l("va-dropdown");return s(),i("div",U,[u(P,{modelValue:e.isOpenSync,"onUpdate:modelValue":t[9]||(t[9]=t=>e.isOpenSync=t),offset:[0,10],"close-on-content-click":!1,disabled:e.disabled},{anchor:p((()=>[d(e.$slots,"input",c(m({valueText:e.valueText,inputProps:e.inputProps,color:e.color})),(()=>[u(C,v(e.inputProps,{ref:"input",class:"va-date-input__input","model-value":e.valueText,error:e.hasError,"error-messages":e.computedErrorMessages,readonly:e.readonly||!e.manualInput,onChange:e.onInputTextChanged}),f({prependInner:p((t=>[d(e.$slots,"prependInner",c(m(t))),e.$props.leftIcon?(s(),y(V,c(v({key:0},e.iconProps)),null,16)):j("v-if",!0)])),icon:p((()=>[e.canBeCleared?(s(),y(V,v({key:0},e.clearIconProps,{onClick:t[0]||(t[0]=g((t=>e.reset()),["stop"]))}),null,16)):e.$props.leftIcon?j("v-if",!0):(s(),y(V,c(v({key:1},e.iconProps)),null,16))])),_:2},[D(e.filterSlots,(t=>({name:t,fn:p((a=>[d(e.$slots,t,c(m(a)))]))})))]),1040,["model-value","error","error-messages","readonly","onChange"])]))])),default:p((()=>[u(h,null,{default:p((()=>[u(I,v(e.datePickerProps,{modelValue:e.valueComputed,"onUpdate:modelValue":t[1]||(t[1]=t=>e.valueComputed=t),"onClick:day":t[2]||(t[2]=t=>e.$emit("click:day",t)),"onClick:month":t[3]||(t[3]=t=>e.$emit("click:month",t)),"onClick:year":t[4]||(t[4]=t=>e.$emit("click:year",t)),"onHover:day":t[5]||(t[5]=t=>e.$emit("hover:day",t)),"onHover:month":t[6]||(t[6]=t=>e.$emit("hover:month",t)),"onHover:year":t[7]||(t[7]=t=>e.$emit("hover:year",t)),"onUpdate:view":t[8]||(t[8]=t=>e.$emit("update:view",t))}),f({_:2},[D(e.$slots,((t,a)=>({name:a,fn:p((t=>[d(e.$slots,a,c(m(t)))]))})))]),1040,["modelValue"])])),_:3})])),_:3},8,["modelValue","disabled"])])},H.__file="src/components/va-date-input/VaDateInput.vue";const q=e(H);export{q as VaDateInput};
//# sourceMappingURL=index23.js.map
