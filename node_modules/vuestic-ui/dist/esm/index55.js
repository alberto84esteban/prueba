import{w as t}from"./withConfigTransport.js";import{__decorate as o}from"tslib";import{h as e,resolveComponent as s,openBlock as i,createBlock as a,Transition as n,withCtx as r,withDirectives as l,createElementVNode as c,normalizeClass as p,normalizeStyle as f,createElementBlock as d,toDisplayString as v,createCommentVNode as u,vShow as h,createVNode as m,withModifiers as g,render as x}from"vue";import{V as y,m as b,O as C,p as _}from"./vue-class-component.esm-bundler.js";import{s as T}from"./VaIcon.js";import{C as z}from"./ColorMixin.js";import{s as k}from"./style-inject.es.js";import"./VaConfig.js";import"./flatten.js";import"./color-config.js";import"colortranslator";import"./useSize.js";const w=y.with(class VaToastRendererProps{constructor(){this.content=_({type:Function,default:void 0})}});let j=class VaToastRenderer extends(b(w)){render(){return this.content(e)}};j=o([C({name:"VaToastRenderer"})],j);const V=y.with(class ToastProps{constructor(){this.title=_({type:String,default:""}),this.offsetY=_({type:Number,default:16}),this.offsetX=_({type:Number,default:16}),this.message=_({type:[String,Function],default:""}),this.html=_({type:Boolean,default:!1}),this.icon=_({type:String,default:"close"}),this.customClass=_({type:String,default:""}),this.duration=_({type:Number,default:5e3}),this.color=_({type:String,default:""}),this.closeable=_({type:Boolean,default:!0}),this.onClose=_({type:[Function,void 0]}),this.onClick=_({type:[Function,void 0]}),this.multiLine=_({type:Boolean,default:!1}),this.position=_({type:String,default:"top-right",validator:t=>["top-right","top-left","bottom-right","bottom-left"].includes(t)}),this.render=_({type:Function,default:void 0})}});let $=class VaToast extends(b(z,V)){constructor(){super(...arguments),this.timer=null,this.visible=!1}get positionX(){return this.position.includes("right")?"right":"left"}get positionY(){return this.position.includes("top")?"top":"bottom"}get toastClasses(){return[this.customClass]}get toastStyles(){return{[this.positionY]:`${this.offsetY}px`,[this.positionX]:`${this.offsetX}px`,backgroundColor:this.colorComputed}}get computedMessage(){return"function"==typeof this.message?this.message():this.message}destroyElement(){this.$el.removeEventListener("transitionend",this.destroyElement),this.$el.remove()}onToastClick(){"function"!=typeof this.$props.onClick?this.$emit("click"):this.$props.onClick()}onToastClose(){this.visible=!1,this.$el.addEventListener("transitionend",this.destroyElement),"function"!=typeof this.onClose?this.$emit("close"):this.onClose()}clearTimer(){this.timer&&clearTimeout(this.timer)}startTimer(){this.duration>0&&(this.timer=setTimeout((()=>{this.visible&&this.onToastClose()}),this.duration))}mounted(){this.visible=!0,this.duration>0&&(this.timer=setTimeout((()=>{this.visible&&this.onToastClose()}),this.duration))}};$=o([C({name:"VaToast",components:{VaIcon:T,VaToastRenderer:j},emits:["on-click","on-close"]})],$);var X=$;const E={class:"va-toast__group"},S=["textContent"],Y={class:"va-toast__content"},M=["innerHTML"],N=["textContent"],L={key:1,class:"va-toast__content"};k(":root{--va-toast-display:flex;--va-toast-width:330px;--va-toast-padding:14px 26px 14px 13px;--va-toast-border-radius:8px;--va-toast-box-sizing:border-box;--va-toast-border:1px solid #ebeef5;--va-toast-position:fixed;--va-toast-background-color:#fff;--va-toast-color:#fff;--va-toast-border-color:#fff;--va-toast-box-shadow:0 2px 12px 0 rgba(0,0,0,0.1);--va-toast-transition:opacity 0.3s,transform 0.3s,left 0.3s,right 0.3s,top 0.4s,bottom 0.3s;--va-toast-overflow:hidden;--va-toast-z-index:calc(var(--va-z-index-teleport-overlay) + 100);--va-toast-group-margin-left:13px;--va-toast-group-margin-right:8px;--va-toast-title-font-weight:bold;--va-toast-title-font-size:1rem;--va-toast-title-color:#303133;--va-toast-title-margin:0 0 6px;--va-toast-content-font-size:1rem;--va-toast-content-line-height:21px;--va-toast-content-padding-right:20px;--va-toast-icon-height:24px;--va-toast-icon-width:24px;--va-toast-icon-font-size:24px;--va-toast-close-icon-position:absolute;--va-toast-close-icon-top:18px;--va-toast-close-icon-right:15px;--va-toast-close-icon-cursor:pointer;--va-toast-close-icon-font-size:1rem;--va-toast-hover-color:#909399}.va-toast{align-items:center;background-color:#fff;border:1px solid var(--va-toast-border-color);border-radius:8px;box-shadow:0 2px 12px 0 rgba(0,0,0,.1);box-sizing:border-box;color:#fff;display:flex;font-family:var(--va-font-family);overflow:hidden;padding:14px 26px 14px 13px;position:fixed;transition:opacity .3s,transform .3s,left .3s,right .3s,top .4s,bottom .3s;width:330px;z-index:var(--va-toast-z-index)}.va-toast--multiline{min-height:70px}.va-toast--right{right:16px}.va-toast--left{left:16px}.va-toast__group{margin-left:var(--va-toast-group-margin-left);margin-right:var(--va-toast-group-margin-right)}.va-toast__title{color:var(--va-toast-title-color);font-size:var(--va-toast-title-font-size);font-weight:var(--va-toast-title-font-weight);margin:var(--va-toast-title-margin)}.va-toast__content{font-size:var(--va-toast-content-font-size);line-height:var(--va-toast-content-line-height);padding-right:var(--va-toast-content-padding-right)}.va-toast__content p{margin:0}.va-toast__icon{font-size:var(--va-toast-icon-font-size);height:var(--va-toast-icon-height);width:var(--va-toast-icon-width)}.va-toast__close-icon{cursor:pointer;font-size:1rem;position:absolute;right:15px;top:50%;transform:translateY(-50%)}.va-toast__close-icon:hover{color:var(--va-toast-hover-color)}.va-toast-fade-enter.right{right:0;transform:translateX(100%)}.va-toast-fade-enter.left{left:0;transform:translateX(-100%)}.va-toast-fade-leave-active{opacity:0}"),X.render=function render(t,o,e,x,y,b){const C=s("VaToastRenderer"),_=s("va-icon");return i(),a(n,{name:"va-toast-fade"},{default:r((()=>[l(c("div",{class:p(["va-toast",t.$props.multiLine?"va-toast--multiline":"",...t.toastClasses]),style:f(t.toastStyles),onMouseenter:o[0]||(o[0]=o=>t.clearTimer()),onMouseleave:o[1]||(o[1]=o=>t.startTimer()),onClick:o[2]||(o[2]=o=>t.onToastClick()),role:"alert"},[c("div",E,[t.title?(i(),d("h2",{key:0,class:"va-toast__title",textContent:v(t.title)},null,8,S)):u("v-if",!0),l(c("div",Y,[t.html?(i(),d("p",{key:0,innerHTML:t.computedMessage},null,8,M)):(i(),d("p",{key:1,textContent:v(t.computedMessage)},null,8,N))],512),[[h,t.message]]),t.render?(i(),d("div",L,[m(C,{content:t.render},null,8,["content"])])):u("v-if",!0),t.closeable?(i(),a(_,{key:2,size:"small",name:t.icon,class:"va-toast__close-icon",onClick:g(t.onToastClose,["stop"])},null,8,["name","onClick"])):u("v-if",!0)])],38),[[h,t.visible]])])),_:1})},X.__file="src/components/va-toast/VaToast.vue";var F=t(X);let R=1,H=[];const getNodeProps=t=>{var o,e;return null===(e=null===(o=t.component)||void 0===o?void 0:o.proxy)||void 0===e?void 0:e.computedProps},closeNotification=(t,o)=>{var e;if(!t)return;if(!H.length)return void(R=1);const s=H.findIndex((o=>o===t));if(s<0)return;const i=getNodeProps(t),{offsetX:a,offsetY:n,position:r}=i,l=null===(e=t.el)||void 0===e?void 0:e.offsetHeight;o(),H=H.reduce(((o,e,i)=>{if(e===t)return o;if(e.component){const{offsetX:t,offsetY:o,position:c}=getNodeProps(e);if(i>s&&a===t&&n===o&&r===c&&e.el&&l){const[t,o]=e.el.style.transform.match(/[\d-]+(?=px)/g),s=((t,o,e)=>{const s=e.includes("bottom")?-1:1;return parseInt(t,10)-(o+5)*s})(o,l,c);e.el.style.transform=`translate(0, ${s}px)`}}return[...o,e]}),[]),H.length||(R=1)},mount=(t,{props:o,children:e,element:s,app:i}={})=>{let a,n=s;return a=m(t,{...o,onClose:()=>{closeNotification(a,(()=>((t,o)=>{t&&(x(null,t),t.remove()),t=null})(n))),(null==o?void 0:o.onClose)&&o.onClose()}},e),(null==i?void 0:i._context)&&(a.appContext=i._context),n?x(a,n):"undefined"!=typeof document&&x(a,n=document.createElement("div")),{vNode:a,el:n}},getToastOptions=t=>("string"==typeof t&&(t={message:t}),((t,...o)=>(o.forEach((o=>{if("object"==typeof o)for(const e in o)if(Object.prototype.hasOwnProperty.call(o,e)){const s=o[e];void 0!==s&&(t[e]=s)}})),t))({},t)),initNotification=(t,o)=>{const e=((t,o)=>{const{vNode:e,el:s}=mount(F,{app:o,props:t}),i=getNodeProps(e);if(s&&e.el&&i){document.body.appendChild(s.childNodes[0]);const{offsetX:t,offsetY:o,position:a}=i;e.el.style.display="flex",e.el.id="notification_"+R;let n=0;return H.filter((e=>{const{offsetX:s,offsetY:i,position:n}=getNodeProps(e);return s===t&&i===o&&a===n})).forEach((t=>{n+=((t,o)=>{if(t.el){const e=o.includes("bottom")?-1:1;return(t.el.offsetHeight+5)*e}return 0})(t,a)})),e.el.style.transform=`translate(0, ${n}px)`,R+=1,e}return null})(getToastOptions(t),o);return e&&H.push(e),e};class Notification{constructor(t){this.app=t}init(t){var o,e;return null===(e=null===(o=initNotification(t,this.app))||void 0===o?void 0:o.el)||void 0===e?void 0:e.id}close(t){(t=>{const o=H.find((o=>{var e;return(null===(e=o.el)||void 0===e?void 0:e.id)===t}));o&&getNodeProps(o).onClose()})(t)}closeAll(){H.length?H.forEach((t=>getNodeProps(t).onClose())):R=1}}export{Notification as default};
//# sourceMappingURL=index55.js.map
