import{w as t}from"./withConfigTransport.js";import{__decorate as o}from"tslib";import{h as e,resolveComponent as s,mergeProps as i,createVNode as a,render as n}from"vue";import{V as r,m as l,O as c,p}from"./vue-class-component.esm-bundler.js";import{s as d}from"./VaIcon.js";import{C as f}from"./ColorMixin.js";import{ssrRenderAttrs as v,ssrInterpolate as h,ssrRenderStyle as u,ssrRenderComponent as m}from"@vue/server-renderer";import{s as g}from"./style-inject.es.js";import"./VaConfig.js";import"./flatten.js";import"./color-config.js";import"colortranslator";import"./useSize.js";const x=r.with(class VaToastRendererProps{constructor(){this.content=p({type:Function,default:void 0})}});let y=class VaToastRenderer extends(l(x)){render(){return this.content(e)}};y=o([c({name:"VaToastRenderer"})],y);const b=r.with(class ToastProps{constructor(){this.title=p({type:String,default:""}),this.offsetY=p({type:Number,default:16}),this.offsetX=p({type:Number,default:16}),this.message=p({type:[String,Function],default:""}),this.html=p({type:Boolean,default:!1}),this.icon=p({type:String,default:"close"}),this.customClass=p({type:String,default:""}),this.duration=p({type:Number,default:5e3}),this.color=p({type:String,default:""}),this.closeable=p({type:Boolean,default:!0}),this.onClose=p({type:[Function,void 0]}),this.onClick=p({type:[Function,void 0]}),this.multiLine=p({type:Boolean,default:!1}),this.position=p({type:String,default:"top-right",validator:t=>["top-right","top-left","bottom-right","bottom-left"].includes(t)}),this.render=p({type:Function,default:void 0})}});let _=class VaToast extends(l(f,b)){constructor(){super(...arguments),this.timer=null,this.visible=!1}get positionX(){return this.position.includes("right")?"right":"left"}get positionY(){return this.position.includes("top")?"top":"bottom"}get toastClasses(){return[this.customClass]}get toastStyles(){return{[this.positionY]:`${this.offsetY}px`,[this.positionX]:`${this.offsetX}px`,backgroundColor:this.colorComputed}}get computedMessage(){return"function"==typeof this.message?this.message():this.message}destroyElement(){this.$el.removeEventListener("transitionend",this.destroyElement),this.$el.remove()}onToastClick(){"function"!=typeof this.$props.onClick?this.$emit("click"):this.$props.onClick()}onToastClose(){this.visible=!1,this.$el.addEventListener("transitionend",this.destroyElement),"function"!=typeof this.onClose?this.$emit("close"):this.onClose()}clearTimer(){this.timer&&clearTimeout(this.timer)}startTimer(){this.duration>0&&(this.timer=setTimeout((()=>{this.visible&&this.onToastClose()}),this.duration))}mounted(){this.visible=!0,this.duration>0&&(this.timer=setTimeout((()=>{this.visible&&this.onToastClose()}),this.duration))}};_=o([c({name:"VaToast",components:{VaIcon:d,VaToastRenderer:y},emits:["on-click","on-close"]})],_);var C=_;g(":root{--va-toast-display:flex;--va-toast-width:330px;--va-toast-padding:14px 26px 14px 13px;--va-toast-border-radius:8px;--va-toast-box-sizing:border-box;--va-toast-border:1px solid #ebeef5;--va-toast-position:fixed;--va-toast-background-color:#fff;--va-toast-color:#fff;--va-toast-border-color:#fff;--va-toast-box-shadow:0 2px 12px 0 rgba(0,0,0,0.1);--va-toast-transition:opacity 0.3s,transform 0.3s,left 0.3s,right 0.3s,top 0.4s,bottom 0.3s;--va-toast-overflow:hidden;--va-toast-z-index:calc(var(--va-z-index-teleport-overlay) + 100);--va-toast-group-margin-left:13px;--va-toast-group-margin-right:8px;--va-toast-title-font-weight:bold;--va-toast-title-font-size:1rem;--va-toast-title-color:#303133;--va-toast-title-margin:0 0 6px;--va-toast-content-font-size:1rem;--va-toast-content-line-height:21px;--va-toast-content-padding-right:20px;--va-toast-icon-height:24px;--va-toast-icon-width:24px;--va-toast-icon-font-size:24px;--va-toast-close-icon-position:absolute;--va-toast-close-icon-top:18px;--va-toast-close-icon-right:15px;--va-toast-close-icon-cursor:pointer;--va-toast-close-icon-font-size:1rem;--va-toast-hover-color:#909399}.va-toast{align-items:center;background-color:#fff;border:1px solid var(--va-toast-border-color);border-radius:8px;box-shadow:0 2px 12px 0 rgba(0,0,0,.1);box-sizing:border-box;color:#fff;display:flex;font-family:var(--va-font-family);overflow:hidden;padding:14px 26px 14px 13px;position:fixed;transition:opacity .3s,transform .3s,left .3s,right .3s,top .4s,bottom .3s;width:330px;z-index:var(--va-toast-z-index)}.va-toast--multiline{min-height:70px}.va-toast--right{right:16px}.va-toast--left{left:16px}.va-toast__group{margin-left:var(--va-toast-group-margin-left);margin-right:var(--va-toast-group-margin-right)}.va-toast__title{color:var(--va-toast-title-color);font-size:var(--va-toast-title-font-size);font-weight:var(--va-toast-title-font-weight);margin:var(--va-toast-title-margin)}.va-toast__content{font-size:var(--va-toast-content-font-size);line-height:var(--va-toast-content-line-height);padding-right:var(--va-toast-content-padding-right)}.va-toast__content p{margin:0}.va-toast__icon{font-size:var(--va-toast-icon-font-size);height:var(--va-toast-icon-height);width:var(--va-toast-icon-width)}.va-toast__close-icon{cursor:pointer;font-size:1rem;position:absolute;right:15px;top:50%;transform:translateY(-50%)}.va-toast__close-icon:hover{color:var(--va-toast-hover-color)}.va-toast-fade-enter.right{right:0;transform:translateX(100%)}.va-toast-fade-enter.left{left:0;transform:translateX(-100%)}.va-toast-fade-leave-active{opacity:0}"),C.ssrRender=function ssrRender(t,o,e,a,n,r,l,c){const p=s("VaToastRenderer"),d=s("va-icon");o(`<div${v(i({style:[t.visible?null:{display:"none"},t.toastStyles],class:["va-toast",t.$props.multiLine?"va-toast--multiline":"",...t.toastClasses],role:"alert"},a))}><div class="va-toast__group">`),t.title?o(`<h2 class="va-toast__title">${h(t.title)}</h2>`):o("\x3c!----\x3e"),o(`<div class="va-toast__content" style="${u(t.message?null:{display:"none"})}">`),t.html?o(`<p>${t.computedMessage}</p>`):o(`<p>${h(t.computedMessage)}</p>`),o("</div>"),t.render?(o('<div class="va-toast__content">'),o(m(p,{content:t.render},null,e)),o("</div>")):o("\x3c!----\x3e"),t.closeable?o(m(d,{size:"small",name:t.icon,class:"va-toast__close-icon"},null,e)):o("\x3c!----\x3e"),o("</div></div>")},C.__file="src/components/va-toast/VaToast.vue";var z=t(C);let T=1,w=[];const getNodeProps=t=>{var o,e;return null===(e=null===(o=t.component)||void 0===o?void 0:o.proxy)||void 0===e?void 0:e.computedProps},closeNotification=(t,o)=>{var e;if(!t)return;if(!w.length)return void(T=1);const s=w.findIndex((o=>o===t));if(s<0)return;const i=getNodeProps(t),{offsetX:a,offsetY:n,position:r}=i,l=null===(e=t.el)||void 0===e?void 0:e.offsetHeight;o(),w=w.reduce(((o,e,i)=>{if(e===t)return o;if(e.component){const{offsetX:t,offsetY:o,position:c}=getNodeProps(e);if(i>s&&a===t&&n===o&&r===c&&e.el&&l){const[t,o]=e.el.style.transform.match(/[\d-]+(?=px)/g),s=((t,o,e)=>{const s=e.includes("bottom")?-1:1;return parseInt(t,10)-(o+5)*s})(o,l,c);e.el.style.transform=`translate(0, ${s}px)`}}return[...o,e]}),[]),w.length||(T=1)},mount=(t,{props:o,children:e,element:s,app:i}={})=>{let r,l=s;return r=a(t,{...o,onClose:()=>{closeNotification(r,(()=>((t,o)=>{t&&(n(null,t),t.remove()),t=null})(l))),(null==o?void 0:o.onClose)&&o.onClose()}},e),(null==i?void 0:i._context)&&(r.appContext=i._context),l?n(r,l):"undefined"!=typeof document&&n(r,l=document.createElement("div")),{vNode:r,el:l}},getToastOptions=t=>("string"==typeof t&&(t={message:t}),((t,...o)=>(o.forEach((o=>{if("object"==typeof o)for(const e in o)if(Object.prototype.hasOwnProperty.call(o,e)){const s=o[e];void 0!==s&&(t[e]=s)}})),t))({},t)),initNotification=(t,o)=>{const e=((t,o)=>{const{vNode:e,el:s}=mount(z,{app:o,props:t}),i=getNodeProps(e);if(s&&e.el&&i){document.body.appendChild(s.childNodes[0]);const{offsetX:t,offsetY:o,position:a}=i;e.el.style.display="flex",e.el.id="notification_"+T;let n=0;return w.filter((e=>{const{offsetX:s,offsetY:i,position:n}=getNodeProps(e);return s===t&&i===o&&a===n})).forEach((t=>{n+=((t,o)=>{if(t.el){const e=o.includes("bottom")?-1:1;return(t.el.offsetHeight+5)*e}return 0})(t,a)})),e.el.style.transform=`translate(0, ${n}px)`,T+=1,e}return null})(getToastOptions(t),o);return e&&w.push(e),e};class Notification{constructor(t){this.app=t}init(t){var o,e;return null===(e=null===(o=initNotification(t,this.app))||void 0===o?void 0:o.el)||void 0===e?void 0:e.id}close(t){(t=>{const o=w.find((o=>{var e;return(null===(e=o.el)||void 0===e?void 0:e.id)===t}));o&&getNodeProps(o).onClose()})(t)}closeAll(){w.length?w.forEach((t=>getNodeProps(t).onClose())):T=1}}export{Notification as default};
//# sourceMappingURL=index55.js.map
