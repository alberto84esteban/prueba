import{p as t,w as e}from"./withConfigTransport.js";import{defineComponent as i,computed as o,ref as n,onBeforeUnmount as f,onMounted as a,nextTick as d,mergeProps as s}from"vue";import{d as r}from"./debounce.js";import{ssrRenderAttrs as l,ssrRenderStyle as u,ssrRenderSlot as c,ssrRenderClass as m}from"@vue/server-renderer";import{s as p}from"./style-inject.es.js";import"./VaConfig.js";import"./toNumber.js";var v=function noop(){},x=r,g=t;var h=function throttle(t,e,i){var o=!0,n=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return g(i)&&(o="leading"in i?!!i.leading:o,n="trailing"in i?!!i.trailing:n),x(t,e,{leading:o,maxWait:e,trailing:n})};function getWindowHeight(){return document.documentElement.clientHeight||window.innerHeight||document.body.clientHeight}function computeAffixedState({coordinates:t,offsetTop:e,offsetBottom:i,target:o}){let n=!1,f=!1;const a=getWindowHeight();if(null!=e&&a)if(o===window)n=t.top<=e;else{const{top:i}=o.getBoundingClientRect();n=t.top-i<=e}if(null!=i&&a)if(o===window)f=t.bottom>=a-i;else{const{bottom:e}=o.getBoundingClientRect();f=e-t.bottom<=i}return{isTopAffixed:n,isBottomAffixed:f}}function handleThrottledEvent(t,e){const{target:i,element:o,offsetTop:n,offsetBottom:f,setState:a,getState:d,initialPosition:s}=e;let r;const l=!t,u=o.getBoundingClientRect(),c={offsetBottom:f,offsetTop:n,target:i};r=computeAffixedState(l&&s?{coordinates:s,...c}:{coordinates:u,...c});const m=d();!function checkAffixedStateChange(t,e){return t.isTopAffixed!==e.isTopAffixed||t.isBottomAffixed!==e.isBottomAffixed}(m,r)?m.width!==u.width&&a({...m,width:u.width}):a({...r,width:u.width})}function useCaptureDefault(t){return"scroll"===t}var w=i({name:"VaAffix",emits:["change"],props:{offsetTop:{type:Number,default:void 0},offsetBottom:{type:Number,default:void 0},target:{type:Function,default:()=>()=>window}},setup(t,{emit:e}){const getTargetElement=()=>t.target(),i=o((()=>s.value.isTopAffixed||s.value.isBottomAffixed)),s=n({isTopAffixed:!1,isBottomAffixed:!1}),getState=()=>s.value,setState=t=>{s.value=t,e("change",i)},calculateTop=()=>{const e=getTargetElement();if(void 0!==t.offsetTop){if(!(e instanceof Window)){const{top:i}=e.getBoundingClientRect();return i+t.offsetTop}return t.offsetTop}},calculateBottom=()=>{const e=getTargetElement();if(void 0!==t.offsetBottom){if(!(e instanceof Window)){const{bottom:i}=e.getBoundingClientRect(),{borderTopWidth:o,borderBottomWidth:n}=getComputedStyle(e),{offsetHeight:f,clientHeight:a}=e,d=f-a-parseInt(o)-parseInt(n);return getWindowHeight()-(i-t.offsetBottom)+d}return t.offsetBottom}},convertToPixels=t=>{const e=t();return void 0===e?void 0:`${e}px`},r=o((()=>[{"va-affix--affixed":i}])),l=o((()=>({top:s.value.isTopAffixed?convertToPixels(calculateTop):void 0,bottom:s.value.isBottomAffixed?convertToPixels(calculateBottom):void 0,width:`${s.value.width}px`}))),u=n(),c=n(null),throttledEventHandler=(e,i)=>{const o={...t,initialPosition:u.value,element:c.value,target:getTargetElement(),setState:setState,getState:getState};if(e&&"resize"!==e){if(i&&i.target){const t=getTargetElement();t===i.target||t instanceof Window?handleThrottledEvent(e,o):setState({isBottomAffixed:!1,isTopAffixed:!1})}}else handleThrottledEvent(e,o)};let m=v;return f((()=>m())),a((()=>{var t;u.value=null===(t=c.value)||void 0===t?void 0:t.getBoundingClientRect(),m=function useEventsHandlerWithThrottle(t,{handler:e,useCapture:i=useCaptureDefault,wait:o=50}){const n=t.map((t=>{const n=h((i=>e(t,i)),o);return window.addEventListener(t,n,i(t)),()=>window.removeEventListener(t,n,i(t))}));return()=>n.forEach((t=>t()))}(["scroll","resize"],{handler:throttledEventHandler}),d((()=>{throttledEventHandler(null)}))})),{computedClass:r,computedStyle:l,isAffixed:i,element:c}}});p(":root{--va-affix-affixed-z-index:10;--va-affix-affixed-position:fixed}.va-affix{font-family:var(--va-font-family)}.va-affix--affixed{position:var(--va-affix-affixed-position);z-index:var(--va-affix-affixed-z-index)}"),w.ssrRender=function ssrRender(t,e,i,o,n,f,a,d){e(`<div${l(s({ref:"element",class:"va-affix"},o))}><div style="${u({visibility:t.isAffixed?"hidden":"inherit"})}">`),c(t.$slots,"default",{},null,e,i),e("</div>"),t.isAffixed?(e(`<div class="${m(t.computedClass)}" style="${u(t.computedStyle)}">`),c(t.$slots,"default",{},null,e,i),e("</div>")):e("\x3c!----\x3e"),e("</div>")},w.__file="src/components/va-affix/VaAffix.vue";var A=e(w);export{A as default};
//# sourceMappingURL=index2.js.map
